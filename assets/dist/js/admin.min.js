class WofSettings{constructor(e,t,l){this.wrapper=document.getElementById(e),this.addSelectBtn=document.getElementById(t),this.addTitleBtn=document.getElementById(l),this.init()}init(){this.addSelectBtn&&this.addSelectBtn.addEventListener("click",this.addSelectRow.bind(this)),this.addTitleBtn&&this.addTitleBtn.addEventListener("click",this.addTitleRow.bind(this)),this.wrapper&&this.wrapper.addEventListener("click",this.handleWrapperClick.bind(this)),this.initTooltips(),this.toggleDeleteButtons()}initTooltips(){[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).forEach(e=>new bootstrap.Tooltip(e))}handleWrapperClick(e){var t=e.target.closest(".delete-row");t&&(e.preventDefault(),!(e=t.closest(".select-container")||t.closest(".titles-container"))||e.parentElement.querySelectorAll("."+e.classList[0]).length<=1||(e.remove(),this.recalculateIndexes(),this.toggleDeleteButtons()))}recalculateIndexes(){this.wrapper.querySelectorAll(".select-container").forEach((e,l)=>{e.setAttribute("data-index",l),e.querySelectorAll("[name]").forEach(e=>{var t=e.getAttribute("name");t&&(t=t.replace(/\[\d+]/,`[${l}]`),e.setAttribute("name",t))})}),this.wrapper.querySelectorAll(".titles-container").forEach((e,l)=>{e.setAttribute("data-index",l),e.querySelectorAll("[name]").forEach(e=>{var t=e.getAttribute("name");t&&(t=t.replace(/\[\d+]/,`[${l}]`),e.setAttribute("name",t))})}),this.toggleDeleteButtons()}toggleDeleteButtons(){["select-container","titles-container"].forEach(e=>{e=this.wrapper.querySelectorAll("."+e);let t=e.length<=1;e.forEach(e=>{e=e.querySelector(".delete-row");e&&(e.style.display=t?"none":"")})})}addSelectRow(e){e.preventDefault();var e=this.wrapper.querySelectorAll(".select-container"),t=e[e.length-1];let l=e.length;t&&((e=t.cloneNode(!0)).setAttribute("data-index",l),e.querySelectorAll("input").forEach(e=>{var t=e.type.toLowerCase(),t=(["text","email","number","tel","url","search","password"].includes(t)?e.value="":["checkbox","radio"].includes(t)&&(e.checked=!1),e.getAttribute("name"));t&&(t=t.replace(/\[\d+]/,`[${l}]`),e.setAttribute("name",t))}),t.insertAdjacentElement("afterend",e),this.initTooltips(),this.recalculateIndexes())}addTitleRow(e){e.preventDefault();var e=this.wrapper.querySelectorAll(".titles-container"),t=e[e.length-1];let l=e.length;t&&((e=t.cloneNode(!0)).setAttribute("data-index",l),e.querySelectorAll("input").forEach(e=>{var t=e.type.toLowerCase(),t=(["text","email","number","tel","url","search","password"].includes(t)?e.value="":["checkbox","radio"].includes(t)&&(e.checked=!1),e.getAttribute("name"));t&&(t=t.replace(/\[\d+]/,`[${l}]`),e.setAttribute("name",t))}),t.insertAdjacentElement("afterend",e),this.initTooltips(),this.recalculateIndexes())}}document.addEventListener("DOMContentLoaded",()=>{new WofSettings("wof-wrapper","add-select-btn","add-title-btn")});