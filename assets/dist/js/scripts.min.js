class WheelOfFortune{static messages={invalidPhone:"Введіть коректний номер у форматі +380XXXXXXXXX",processing:"Обробка...",connectionError:"Помилка зʼєднання з сервером",errorOccurred:"Сталася помилка",alreadyPlayed:"Ви вже брали участь.",successPrefix:"Ви виграли: "};constructor(e){this.modal=document.getElementById(e.modalId),this.triggerBtn=document.getElementById(e.triggerBtnId),this.spinBtn=document.getElementById(e.spinBtnId),this.phoneInput=document.getElementById(e.phoneInputId),this.resultEl=document.getElementById(e.resultElId),this.ajaxUrl=e.ajaxUrl,this.nonce=e.nonce,this.init()}init(){setTimeout(()=>this.showModal(),15e3),document.addEventListener("mouseleave",e=>{e.clientY<0&&this.showModal()}),this.triggerBtn.addEventListener("click",()=>this.showModal()),this.spinBtn.addEventListener("click",()=>this.handleSpin())}showModal(){this.modal.classList.remove("wof-hidden")}handleSpin(){var e=this.phoneInput.value.trim();/^\+380\d{9}$/.test(e)?(this.resultEl.textContent=WheelOfFortune.messages.processing,fetch(this.ajaxUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:"wof_spin",nonce:this.nonce,phone:e})}).then(e=>e.json()).then(e=>{var t;e.success?(this.resultEl.textContent=WheelOfFortune.messages.successPrefix+e.data.result,"function"==typeof Cart&&"function"==typeof(t=new Cart).updateCartInformation&&t.updateCartInformation()):(t=e.data?.message||WheelOfFortune.messages.errorOccurred,this.resultEl.textContent=t)}).catch(()=>{this.resultEl.textContent=WheelOfFortune.messages.connectionError})):this.resultEl.textContent=WheelOfFortune.messages.invalidPhone}}document.addEventListener("DOMContentLoaded",()=>{new WheelOfFortune({modalId:"wof-modal",triggerBtnId:"wof-trigger-btn",spinBtnId:"wof-spin-btn",phoneInputId:"wof-phone",resultElId:"wof-result",ajaxUrl:WOF_JS.ajax_url,nonce:WOF_JS.nonce})});